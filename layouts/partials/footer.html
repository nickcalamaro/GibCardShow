<footer id="site-footer" class="py-10 print:hidden">
  {{/* Footer menu */}}

  <style>

.sponsor-carousel {
  position: relative;
  display: flex;
  align-items: center;
  overflow: hidden;
  max-width: 100%;
  padding: 1rem 0;
  background: rgba(255,255,255,0.05);
}

.carousel-track {
  display: flex;
  gap: 1rem;
  overflow-x: scroll;
  scroll-behavior: smooth;
  scrollbar-width: none;
}
.carousel-track::-webkit-scrollbar { display: none; }

.carousel-track img {
  flex: 0 0 auto;
  width: 150px;
  height: 150px;
  object-fit: contain;
  border-radius: 8px;
  background: #fff;
  padding: 0.5rem;
  box-shadow: 0 2px 6px rgba(0,0,0,0.15);
  transition: transform 0.2s ease;
}
.carousel-track img:hover { transform: scale(1.05); }

.carousel-btn {
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  background: rgba(0,0,0,0.5);
  color: #fff;
  border: none;
  font-size: 2rem;
  padding: 0.25rem 0.5rem;
  cursor: pointer;
  z-index: 2;
}
.carousel-btn.prev { left: 0; }
.carousel-btn.next { right: 0; }

@media (max-width: 640px) {
  .carousel-btn { display: none; }
  .carousel-track img { width: 120px; height: 120px; }
}
</style>




<h1>Our Sponsors</h1>
<div class="sponsor-carousel">
  <button class="carousel-btn prev" aria-label="Previous">‹</button>
  <div class="carousel-track">
    {{ $logos := slice
        "toycorner-sponsor.png"
        "vijay-sponsor.png"
        "cardmarket-sponsor.png"
        "dicebastion-sponsor.png"
        "southernlight-sponsor.png"
        "pbcs-sponsor.png"
        "wise-sponsor.png"
        "gcs-sponsor.png"
    }}
    {{ range $logos }}
      {{ $img := resources.Get (printf "img/sponsors/%s" .) | fingerprint }}
      <img src="{{ $img.RelPermalink }}" alt="{{ replace (replace . "-sponsor.png" "") "-" " " | title }}">
    {{ end }}
  </div>
  <button class="carousel-btn next" aria-label="Next">›</button>
</div>


  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js" defer></script>

  {{ if .Site.Params.footer.showMenu | default true }}
    {{ if .Site.Menus.footer }}
    <nav class="flex flex-row pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400">
      <ul class="flex flex-col list-none sm:flex-row">
        {{ range .Site.Menus.footer }}
        <li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0">
          <a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href="{{ .URL }}"
            title="{{ .Title }}">
            {{ if .Pre }}
            <span {{ if and .Pre .Name}} class="mr-1" {{ end }}>
                {{ partial "icon.html" .Pre }}
            </span>
            {{ end }}
            {{ .Name | markdownify }}
          </a>
        </li>
        {{ end }}
      </ul>
    </nav>
    {{ end }}
  {{ end }}
  <div class="flex items-center justify-between">

    {{/* Copyright */}}
    {{ if .Site.Params.footer.showCopyright | default true }}
    <p class="text-sm text-neutral-500 dark:text-neutral-400">
      {{- with replace .Site.Params.copyright "{ year }" now.Year  }}
      {{ . | markdownify }}
      {{- else }}
      &copy;
      {{ now.Format "2006" }}
      {{ .Site.Params.Author.name | markdownify }}
      {{- end }}
    </p>
    {{ end }}

    {{/* Theme attribution */}}
    {{ if .Site.Params.footer.showThemeAttribution | default true }}
    <p class="text-xs text-neutral-500 dark:text-neutral-400">
      {{ $hugo := printf `<a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
        href="https://gohugo.io/" target="_blank" rel="noopener noreferrer">Hugo</a>`
      }}
      {{ $blowfish := printf `<a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
        href="https://blowfish.page/" target="_blank" rel="noopener noreferrer">Blowfish</a>` }}
      {{ i18n "footer.powered_by" (dict "Hugo" $hugo "Theme" $blowfish) | safeHTML }}
    </p>
    {{ end }}

</div>
<script>
  {{ if not .Site.Params.disableImageZoom | default true }}
  mediumZoom(document.querySelectorAll("img:not(.nozoom)"), {
    margin: 24,
    background: 'rgba(0,0,0,0.5)',
    scrollOffset: 0,
  })
  {{ end }}
</script>
{{ $jsProcess := resources.Get "js/process.js" }}
{{ $jsProcess = $jsProcess | resources.Minify | resources.Fingerprint "sha512" }}
<script type="text/javascript" src="{{ $jsProcess.RelPermalink }}" integrity="{{ $jsProcess.Data.Integrity }}"></script>
{{/* Extend footer - eg. for extra scripts, etc. */}}
{{ if templates.Exists "partials/extend-footer.html" }}
{{ partialCached "extend-footer.html" . }}

{{ end }}

<script>
document.addEventListener('DOMContentLoaded', () => {
  const track = document.querySelector('.carousel-track');
  const prevBtn = document.querySelector('.carousel-btn.prev');
  const nextBtn = document.querySelector('.carousel-btn.next');

  // 1) Build arrays
  const originals = Array.from(track.children);
  const originalsCount = originals.length;

  // 2) Clone to both ends (end, then start)
  originals.forEach(n => track.appendChild(n.cloneNode(true)));
  originals.slice().reverse().forEach(n => track.insertBefore(n.cloneNode(true), track.firstChild));

  // 3) Helper: wait for images to be fully loaded
  function waitForImages() {
    const imgs = Array.from(track.querySelectorAll('img'));
    if (imgs.length === 0) return Promise.resolve();
    return Promise.all(
      imgs.map(img => {
        if (img.complete && img.naturalWidth) return Promise.resolve();
        return new Promise(res => img.addEventListener('load', res, { once: true }));
      })
    );
  }

  // 4) Helper: next animation frame (twice for safety)
  const raf = () => new Promise(res => requestAnimationFrame(res));
  async function nextFrames(n = 2) {
    while (n-- > 0) await raf();
  }

  // 5) After layout, compute widths precisely and jump invisibly
  let itemWidth = 0;
  let offset = 0; // width of one originals set
  let isResetting = false;

  function computeItemWidth() {
    const first = track.children[originalsCount]; // first item in the originals set (middle block)
    if (!first) return 0;
    const rect = first.getBoundingClientRect();
    const styles = getComputedStyle(track);
    // Prefer 'column-gap' (Firefox) else 'gap'
    const gap = parseFloat(styles.columnGap || styles.gap || 0) || 0;
    return rect.width + gap;
  }

  async function initPosition() {
    // Wait for images and layout to settle
    await waitForImages();
    await nextFrames(2);

    itemWidth = computeItemWidth();
    offset = originalsCount * itemWidth;

    // Turn off smooth behavior for the initial jump
    const prevBehavior = track.style.scrollBehavior;
    track.style.scrollBehavior = 'auto';

    isResetting = true; // suppress scroll handler during the jump
    track.scrollLeft = offset;
    // one more frame to lock position, then restore
    await raf();
    isResetting = false;
    track.style.scrollBehavior = prevBehavior || '';
  }

  // 6) Manual controls (arrows)
  function scrollByItems(n) {
    track.scrollBy({ left: n * itemWidth, behavior: 'smooth' });
  }
  prevBtn.addEventListener('click', () => scrollByItems(-1));
  nextBtn.addEventListener('click', () => scrollByItems(1));

  // 7) Drag/Swipe
  let isDown = false, startX = 0, startLeft = 0;
  track.addEventListener('mousedown', (e) => {
    isDown = true;
    startX = e.pageX;
    startLeft = track.scrollLeft;
    track.classList.add('dragging');
  });
  track.addEventListener('mouseleave', () => { isDown = false; track.classList.remove('dragging'); });
  track.addEventListener('mouseup', () => { isDown = false; track.classList.remove('dragging'); });
  track.addEventListener('mousemove', (e) => {
    if (!isDown) return;
    e.preventDefault();
    track.scrollLeft = startLeft - (e.pageX - startX);
  });

  // Touch
  let touchStartX = 0, touchStartLeft = 0;
  track.addEventListener('touchstart', (e) => {
    touchStartX = e.touches[0].pageX;
    touchStartLeft = track.scrollLeft;
  }, { passive: true });
  track.addEventListener('touchmove', (e) => {
    const x = e.touches[0].pageX;
    track.scrollLeft = touchStartLeft - (x - touchStartX);
  }, { passive: true });

  // 8) Infinite illusion: only reset when far into clones (no jitter)
  track.addEventListener('scroll', () => {
    if (isResetting || !itemWidth) return;

    const leftBoundary = (originalsCount - 1) * itemWidth;
    const rightBoundary = (originalsCount * 2 + 1) * itemWidth;

    if (track.scrollLeft <= leftBoundary) {
      isResetting = true;
      const prevBehavior = track.style.scrollBehavior;
      track.style.scrollBehavior = 'auto';
      track.scrollLeft += offset; // jump forward one originals set
      // release on next frame
      requestAnimationFrame(() => {
        track.style.scrollBehavior = prevBehavior || '';
        isResetting = false;
      });
    } else if (track.scrollLeft >= rightBoundary) {
      isResetting = true;
      const prevBehavior = track.style.scrollBehavior;
      track.style.scrollBehavior = 'auto';
      track.scrollLeft -= offset; // jump back one originals set
      requestAnimationFrame(() => {
        track.style.scrollBehavior = prevBehavior || '';
        isResetting = false;
      });
    }
  });

  // 9) Initialize
  initPosition();

  // 10) Safety: re-init if fonts/layout change (e.g., after a resize)
  let resizeTimer;
  window.addEventListener('resize', () => {
    clearTimeout(resizeTimer);
    resizeTimer = setTimeout(async () => {
      await nextFrames(1);
      itemWidth = computeItemWidth();
      offset = originalsCount * itemWidth;
      // keep position centered in originals block
      const prevBehavior = track.style.scrollBehavior;
      track.style.scrollBehavior = 'auto';
      track.scrollLeft = offset;
      track.style.scrollBehavior = prevBehavior || '';
    }, 150);
  });
});
</script>

  
</footer>
